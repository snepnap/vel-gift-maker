<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Valentine Builder ‚Ä¢ Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <style>
        :root {
            /* Premium Dark Mode Design System */
            --background: 0 0% 3.9%;
            --foreground: 0 0% 98%;
            --card: 240 6% 6%;
            --card-foreground: 0 0% 98%;
            --popover: 240 6% 6%;
            --popover-foreground: 0 0% 98%;
            --primary: 346.8 77.2% 49.8%;
            --primary-foreground: 355.7 100% 97.3%;
            --secondary: 240 4% 16%;
            --secondary-foreground: 0 0% 98%;
            --muted: 240 4% 16%;
            --muted-foreground: 240 5% 64.9%;
            --accent: 240 4% 16%;
            --accent-foreground: 0 0% 98%;
            --destructive: 0 62.8% 30.6%;
            --destructive-foreground: 0 0% 98%;
            --border: 240 4% 16%;
            --input: 240 4% 16%;
            --ring: 346.8 77.2% 49.8%;
            --radius: 0.75rem;

            /* Premium Tokens */
            --bg-primary: #09090b;
            --bg-secondary: #0f0f12;
            --bg-tertiary: #18181b;
            --bg-glass: rgba(15, 15, 18, 0.8);
            --border-color: rgba(255, 255, 255, 0.06);
            --border-glow: rgba(244, 63, 94, 0.3);
            --text-primary: #fafafa;
            --text-secondary: #a1a1aa;
            --text-muted: #71717a;
            --accent-rose: #f43f5e;
            --accent-purple: #a855f7;
            --accent-cyan: #22d3ee;
            --glass-blur: 24px;
            --transition-smooth: cubic-bezier(0.4, 0, 0.2, 1);

            /* Gradients */
            --gradient-brand: linear-gradient(135deg, #f43f5e 0%, #a855f7 100%);
            --gradient-glow: linear-gradient(135deg, rgba(244, 63, 94, 0.2) 0%, rgba(168, 85, 247, 0.1) 100%);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            overflow: hidden;
            height: 100vh;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Animated Gradient Background */
        .gradient-mesh {
            position: fixed;
            inset: 0;
            z-index: 0;
            pointer-events: none;
            background:
                radial-gradient(ellipse 80% 50% at 10% 90%, rgba(244, 63, 94, 0.08) 0%, transparent 50%),
                radial-gradient(ellipse 60% 40% at 90% 10%, rgba(168, 85, 247, 0.06) 0%, transparent 50%),
                radial-gradient(ellipse 50% 30% at 50% 50%, rgba(34, 211, 238, 0.03) 0%, transparent 50%);
            animation: meshFloat 25s ease-in-out infinite;
        }

        @keyframes meshFloat {

            0%,
            100% {
                transform: translate(0, 0) scale(1);
            }

            33% {
                transform: translate(2%, 1%) scale(1.02);
            }

            66% {
                transform: translate(-1%, 2%) scale(0.98);
            }
        }

        /* Noise Texture Overlay */
        .noise-overlay {
            position: fixed;
            inset: 0;
            z-index: 1;
            pointer-events: none;
            opacity: 0.03;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
        }

        /* Layout */
        .app-layout {
            display: grid;
            grid-template-columns: 72px 1fr 420px;
            height: 100vh;
            position: relative;
            z-index: 1;
        }

        .app-layout.panel-closed {
            grid-template-columns: 72px 1fr 0px;
        }


        /* Sidebar */
        .sidebar {
            background: rgba(9, 9, 11, 0.95);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
            border-right: 1px solid rgba(255, 255, 255, 0.06);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 0;
            gap: 8px;
            z-index: 10;
        }

        .sidebar-logo {
            width: 44px;
            height: 44px;
            background: var(--gradient-brand);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            margin-bottom: 24px;
            box-shadow: 0 4px 20px rgba(244, 63, 94, 0.4);
            animation: logoPulse 3s ease-in-out infinite;
        }

        .sidebar-item {
            width: 44px;
            height: 44px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--text-muted);
            transition: all 0.25s var(--transition-smooth);
            font-size: 18px;
            position: relative;
        }

        .sidebar-item:hover {
            background: rgba(255, 255, 255, 0.06);
            color: var(--text-primary);
            transform: scale(1.05);
        }

        .sidebar-item.active {
            background: var(--gradient-glow);
            color: var(--accent-rose);
            box-shadow: 0 0 20px rgba(244, 63, 94, 0.2);
        }

        .sidebar-item.active::before {
            content: '';
            position: absolute;
            left: -8px;
            width: 3px;
            height: 24px;
            background: var(--gradient-brand);
            border-radius: 0 3px 3px 0;
            box-shadow: 0 0 12px var(--accent-rose);
        }

        .sidebar-item {
            width: 40px;
            height: 40px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--text-muted);
            transition: all 0.2s;
            font-size: 18px;
            position: relative;
        }

        .sidebar-item:hover,
        .sidebar-item.active {
            background: var(--secondary);
            color: var(--foreground);
        }

        @keyframes logoPulse {

            0%,
            100% {
                box-shadow: 0 4px 20px rgba(244, 63, 94, 0.4);
            }

            50% {
                box-shadow: 0 4px 30px rgba(168, 85, 247, 0.5);
            }
        }

        .sidebar-item {
            width: 44px;
            height: 44px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--text-muted);
            transition: all 0.3s var(--transition-smooth);
            font-size: 18px;
            position: relative;
        }

        .sidebar-item:hover {
            background: var(--bg-glass);
            color: var(--text-primary);
            transform: scale(1.08);
        }

        .sidebar-item.active {
            background: linear-gradient(135deg, rgba(244, 63, 94, 0.15), rgba(168, 85, 247, 0.1));
            color: var(--accent);
            box-shadow: 0 0 20px rgba(244, 63, 94, 0.2);
        }

        .sidebar-item.active::before {
            content: '';
            position: absolute;
            left: -8px;
            width: 3px;
            height: 24px;
            background: linear-gradient(180deg, var(--accent), var(--accent-purple));
            border-radius: 0 3px 3px 0;
            box-shadow: 0 0 10px var(--accent);
        }

        .sidebar-item[data-tooltip]:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            left: 60px;
            background: var(--bg-tertiary);
            backdrop-filter: blur(10px);
            padding: 8px 14px;
            border-radius: 10px;
            font-size: 12px;
            font-weight: 500;
            white-space: nowrap;
            z-index: 100;
            border: 1px solid var(--border);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            animation: tooltipFade 0.2s ease;
        }

        @keyframes tooltipFade {
            from {
                opacity: 0;
                transform: translateX(-5px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .sidebar-divider {
            width: 28px;
            height: 1px;
            background: var(--border);
            margin: 8px 0;
        }

        .sidebar-spacer {
            flex: 1;
        }


        .sidebar-divider {
            width: 28px;
            height: 1px;
            background: var(--border);
            margin: 10px 0;
        }

        .sidebar-spacer {
            flex: 1;
        }

        /* Main Canvas */
        .canvas-area {
            background: #030303;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .canvas-pattern {
            position: absolute;
            inset: 0;
            opacity: 0.4;
            background-image: radial-gradient(circle at 1px 1px, rgba(255, 255, 255, 0.03) 1px, transparent 0);
            background-size: 24px 24px;
        }

        /* Device Preview */
        .preview-container {
            position: relative;
            z-index: 10;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .preview-desktop {
            width: calc(100% - 60px);
            height: calc(100% - 60px);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.05), 0 40px 80px -20px rgba(0, 0, 0, 0.8);
        }

        .preview-mobile {
            width: 340px;
            height: 700px;
            border-radius: 44px;
            overflow: hidden;
            background: linear-gradient(145deg, #27272a, #18181b);
            padding: 10px;
            box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.08), 0 50px 100px -20px rgba(0, 0, 0, 0.9), inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }

        .preview-mobile .preview-screen {
            border-radius: 36px;
            height: 100%;
            position: relative;
            overflow: hidden;
            background: #000;
        }

        .preview-mobile {
            width: 370px;
            height: 750px;
            background: #000;
            border-radius: 56px;
            box-shadow:
                0 0 0 2px #334155,
                0 0 0 8px #1e293b,
                0 0 0 10px #0f172a,
                0 40px 80px rgba(0, 0, 0, 0.6);
            position: relative;
            transform-origin: center top;
            transition: all 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
            border: 6px solid #1a1a1a;
            margin-top: 20px;
        }

        .preview-screen {
            width: 100%;
            height: 100%;
            position: relative;
            overflow: hidden;
            background: #000;
            border-radius: 48px;
            mask-image: radial-gradient(white, black);
            -webkit-mask-image: -webkit-radial-gradient(white, black);
            border-radius: 44px;
            /* Slightly tighter than frame */
        }

        .preview-mobile .notch {
            position: absolute;
            top: 14px;
            left: 50%;
            transform: translateX(-50%);
            width: 110px;
            height: 32px;
            background: #000;
            border-radius: 20px;
            z-index: 100;
        }

        .preview-mobile .notch::before {
            content: '';
            position: absolute;
            top: 50%;
            right: 12px;
            width: 10px;
            height: 10px;
            background: #1a1a1a;
            border-radius: 50%;
            transform: translateY(-50%);
        }

        /* Phone Buttons */
        .preview-mobile::before {
            content: '';
            position: absolute;
            top: 160px;
            right: -13px;
            width: 4px;
            height: 50px;
            background: #1e293b;
            border-radius: 0 4px 4px 0;
        }

        .preview-mobile::after {
            content: '';
            position: absolute;
            top: 130px;
            left: -13px;
            width: 4px;
            height: 90px;
            background: #1e293b;
            border-radius: 4px 0 0 4px;
            box-shadow: 0 120px 0 0 #1e293b;
            /* Second button */
        }

        .preview-mobile.landscape {
            width: 750px;
            height: 370px;
            border-radius: 56px;
            margin-top: 50px;
        }


        /* Toolbar */
        .toolbar {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 6px;
            padding: 6px;
            background: rgba(24, 24, 27, 0.95);
            backdrop-filter: blur(16px);
            border: 1px solid var(--border);
            border-radius: 14px;
            z-index: 20;
        }

        .toolbar-btn {
            padding: 8px 18px;
            border-radius: 10px;
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            background: transparent;
        }

        .toolbar-btn:hover {
            color: var(--text-primary);
            background: rgba(255, 255, 255, 0.05);
        }

        .toolbar-btn.active {
            background: var(--text-primary);
            color: var(--bg-primary);
        }

        .toolbar-divider {
            width: 1px;
            height: 24px;
            background: var(--border);
            align-self: center;
        }

        /* Right Panel - Glassmorphism */
        .right-panel {
            background: rgba(9, 9, 11, 0.95);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
            border-left: 1px solid rgba(255, 255, 255, 0.06);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
            z-index: 5;
        }

        .panel-header {
            padding: 20px 24px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.06);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: transparent;
        }

        .panel-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--text-primary);
            letter-spacing: -0.02em;
        }

        .panel-subtitle {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .panel-close {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--text-muted);
            transition: all 0.2s;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .panel-close:hover {
            color: var(--text-primary);
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--border-glow);
        }

        .panel-body {
            flex: 1;
            overflow-y: auto;
            padding: 20px 24px;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .panel-body::-webkit-scrollbar {
            width: 6px;
        }

        .panel-body::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }

        .panel-body::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        /* Form Elements - Premium */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 10px;
        }

        .form-input {
            width: 100%;
            height: 44px;
            padding: 12px 14px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 10px;
            color: var(--text-primary);
            font-size: 14px;
            transition: all 0.25s var(--transition-smooth);
            outline: none;
        }

        .form-input:focus {
            border-color: var(--accent-rose);
            box-shadow: 0 0 0 3px rgba(244, 63, 94, 0.15);
            background: rgba(255, 255, 255, 0.05);
        }

        .form-input::placeholder {
            color: var(--text-muted);
        }

        .form-textarea {
            resize: none;
            min-height: 120px;
            line-height: 1.6;
            height: auto;
        }

        /* Cards - Glass Effect */
        .card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 14px;
            padding: 16px;
            margin-bottom: 12px;
            transition: all 0.3s var(--transition-smooth);
        }

        .card:hover {
            border-color: var(--border-glow);
            background: rgba(255, 255, 255, 0.05);
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        /* Buttons - Premium */
        .btn-primary {
            width: 100%;
            height: 44px;
            padding: 0 20px;
            background: var(--gradient-brand);
            color: white;
            font-weight: 600;
            font-size: 14px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s var(--transition-smooth);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            position: relative;
            overflow: hidden;
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transform: translateX(-100%);
            transition: transform 0.5s;
        }

        .btn-primary:hover::before {
            transform: translateX(100%);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(244, 63, 94, 0.4);
        }

        .btn-secondary {
            width: 100%;
            height: 44px;
            padding: 0 20px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 14px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s var(--transition-smooth);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
            border-color: var(--border-glow);
            transform: translateY(-1px);
        }

        .btn-secondary:hover {
            background: var(--muted);
        }

        .btn-primary:hover::before {
            transform: translateX(100%);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(244, 63, 94, 0.4);
        }

        .btn-secondary {
            width: 100%;
            padding: 12px;
            background: var(--bg-glass);
            backdrop-filter: blur(10px);
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 13px;
            border: 1px solid var(--border);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s var(--transition-smooth);
        }

        .btn-secondary:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border-color: var(--border-glow);
            transform: translateY(-1px);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 12px;
            border-radius: 8px;
        }

        /* Floating Bottom Action Bar - Premium */
        .bottom-action-bar {
            position: fixed;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 10px;
            background: rgba(15, 15, 18, 0.9);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 18px;
            box-shadow: 0 12px 48px rgba(0, 0, 0, 0.5);
            z-index: 100;
        }

        .action-btn {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 10px 16px;
            background: transparent;
            border: none;
            color: var(--text-muted);
            font-size: 13px;
            font-weight: 500;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s var(--transition-smooth);
        }

        .action-btn:hover {
            background: rgba(255, 255, 255, 0.06);
            color: var(--text-primary);
        }

        .action-btn.primary {
            background: var(--gradient-brand);
            color: white;
            font-weight: 600;
        }

        .action-btn.primary:hover {
            box-shadow: 0 4px 20px rgba(244, 63, 94, 0.4);
            transform: translateY(-1px);
        }

        .action-divider {
            width: 1px;
            height: 24px;
            background: rgba(255, 255, 255, 0.08);
            margin: 0 4px;
        }

        /* Progress Indicator */
        .progress-bar {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--border);
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), var(--accent-purple), var(--accent-cyan));
            background-size: 200% 100%;
            animation: progressShimmer 2s linear infinite;
            transition: width 0.5s var(--transition-smooth);
        }

        @keyframes progressShimmer {
            0% {
                background-position: 200% 0;
            }

            100% {
                background-position: -200% 0;
            }
        }

        /* Live Badge */
        .live-badge {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.3);
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            color: #22c55e;
        }

        .live-dot {
            width: 6px;
            height: 6px;
            background: #22c55e;
            border-radius: 50%;
            animation: livePulse 2s ease-in-out infinite;
        }

        @keyframes livePulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.4;
            }
        }

        /* Publish Area */
        .publish-area {
            padding: 20px 24px;
            border-top: 1px solid var(--border);
            background: var(--bg-secondary);
            backdrop-filter: blur(var(--glass-blur));
        }

        /* Animation Effects Toggle Grid */
        .effects-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }

        .effect-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            padding: 12px 8px;
            background: var(--bg-glass);
            border: 1px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s var(--transition-smooth);
            font-size: 12px;
            color: var(--text-muted);
        }

        .effect-item:hover {
            border-color: var(--border-glow);
            transform: scale(1.05);
        }

        /* Panels & Cards */
        .right-panel {
            background: var(--bg-secondary);
            backdrop-filter: blur(var(--glass-blur));
            -webkit-backdrop-filter: blur(var(--glass-blur));
            border-left: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: all 0.4s var(--transition-smooth);
            position: relative;
            z-index: 10;
        }

        .panel-header {
            padding: 24px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.02) 0%, transparent 100%);
        }

        .panel-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
            letter-spacing: -0.5px;
        }

        .panel-subtitle {
            font-size: 13px;
            color: var(--text-muted);
            margin-top: 2px;
        }

        .panel-body {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
            scrollbar-width: thin;
            scrollbar-color: var(--border) transparent;
        }

        .panel-body::-webkit-scrollbar {
            width: 4px;
        }

        .panel-body::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 10px;
        }

        .card {
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 16px;
            transition: all 0.3s var(--transition-smooth);
            position: relative;
            overflow: hidden;
        }

        .card:hover {
            border-color: var(--accent);
            box-shadow: 0 10px 30px -10px rgba(244, 63, 94, 0.2);
        }

        /* Forms */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 13px;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .form-input {
            width: 100%;
            background: var(--input);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 10px 14px;
            color: var(--text-primary);
            font-size: 14px;
            transition: all 0.2s;
            outline: none;
        }

        .form-input:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 2px rgba(244, 63, 94, 0.2);
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        /* Buttons */
        .btn-primary {
            background: linear-gradient(135deg, var(--accent), var(--accent-purple));
            color: white;
            border: none;
            border-radius: 10px;
            padding: 12px 24px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 4px 15px rgba(244, 63, 94, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(244, 63, 94, 0.4);
            opacity: 0.95;
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 10px 20px;
            font-weight: 500;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-secondary:hover {
            background: var(--bg-glass);
            border-color: var(--text-muted);
        }

        .effect-item.active {
            background: linear-gradient(135deg, rgba(244, 63, 94, 0.15), rgba(168, 85, 247, 0.1));
            border-color: var(--accent);
            color: var(--text-primary);
        }

        .effect-item .icon {
            font-size: 24px;
        }

        /* Device Frame Selector */
        .device-selector {
            display: flex;
            gap: 8px;
            padding: 8px;
            background: var(--bg-glass);
            border-radius: 12px;
            margin-bottom: 16px;
        }

        .device-option {
            flex: 1;
            padding: 10px;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            color: var(--text-muted);
            transition: all 0.2s;
            border: 1px solid transparent;
        }

        .device-option:hover {
            color: var(--text-secondary);
        }

        .device-option.active {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border-color: var(--border);
        }

        .device-option .device-icon {
            font-size: 20px;
            margin-bottom: 4px;
        }

        /* Share Buttons */
        .share-buttons {
            display: flex;
            gap: 8px;
        }

        .share-btn {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            padding: 12px;
            border-radius: 12px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
        }

        .share-btn.whatsapp {
            background: #25d366;
            color: white;
        }

        .share-btn.whatsapp:hover {
            background: #20bd5a;
            box-shadow: 0 4px 15px rgba(37, 211, 102, 0.4);
        }

        .share-btn.copy {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            border: 1px solid var(--border);
        }

        .share-btn.copy:hover {
            background: var(--bg-glass);
            color: var(--text-primary);
        }

        .share-btn.download {
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            color: white;
        }

        .share-btn.download:hover {
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.4);
        }

        /* Feature Pills - Horizontal Scroll */
        .feature-pills {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding: 4px 0 12px 0;
            scrollbar-width: none;
        }

        .feature-pills::-webkit-scrollbar {
            display: none;
        }

        .feature-pill {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 14px;
            background: var(--bg-glass);
            border: 1px solid var(--border);
            border-radius: 20px;
            white-space: nowrap;
            cursor: pointer;
            font-size: 12px;
            color: var(--text-muted);
            transition: all 0.2s;
        }

        .feature-pill:hover {
            border-color: var(--border-glow);
            color: var(--text-secondary);
        }

        .feature-pill.active {
            background: linear-gradient(135deg, var(--accent), var(--accent-purple));
            border-color: transparent;
            color: white;
        }

        .feature-pill .pill-icon {
            font-size: 14px;
        }


        /* Theme Cards */
        .theme-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        .theme-card {
            aspect-ratio: 4/3;
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            position: relative;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .theme-card:hover {
            transform: translateY(-4px);
        }

        .theme-card.active {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(244, 63, 94, 0.2);
        }

        .theme-card-bg {
            position: absolute;
            inset: 0;
        }

        .theme-card-info {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 12px;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.9));
        }

        .theme-card-name {
            font-size: 13px;
            font-weight: 600;
        }

        .theme-card-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            padding: 4px 8px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 6px;
            font-size: 10px;
            font-weight: 600;
            color: var(--accent);
        }

        /* Color Picker */
        .color-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 8px;
        }

        .color-swatch {
            width: 100%;
            aspect-ratio: 1;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
        }

        .color-swatch:hover {
            transform: scale(1.1);
        }

        .color-swatch.active {
            border-color: white;
            box-shadow: 0 0 0 2px var(--bg-primary), 0 0 0 4px currentColor;
        }

        /* Font Selector */
        .font-option {
            padding: 14px 16px;
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .font-option:hover {
            border-color: rgba(255, 255, 255, 0.1);
        }

        .font-option.active {
            border-color: var(--accent);
            background: rgba(244, 63, 94, 0.05);
        }

        .font-preview {
            font-size: 18px;
        }

        .font-name {
            font-size: 11px;
            color: var(--text-muted);
        }

        /* Slider */
        .slider-container {
            padding: 8px 0;
        }

        .slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: var(--bg-tertiary);
            appearance: none;
            cursor: pointer;
        }

        .slider::-webkit-slider-thumb {
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--accent);
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(244, 63, 94, 0.4);
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 8px;
            font-size: 11px;
            color: var(--text-muted);
        }

        /* Template Cards */
        .template-grid {
            display: grid;
            gap: 12px;
        }

        .template-card {
            padding: 16px;
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .template-card:hover {
            border-color: rgba(255, 255, 255, 0.1);
            background: var(--bg-tertiary);
        }

        .template-card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 8px;
        }

        .template-card-icon {
            font-size: 24px;
        }

        .template-card-title {
            font-weight: 600;
            font-size: 14px;
        }

        .template-card-desc {
            font-size: 12px;
            color: var(--text-muted);
            line-height: 1.5;
        }

        /* Feature Toggle */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .feature-item {
            padding: 14px 12px;
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .feature-item:hover {
            border-color: rgba(255, 255, 255, 0.12);
        }

        .feature-item.active {
            border-color: var(--accent);
            background: rgba(244, 63, 94, 0.06);
        }

        .feature-item .icon {
            font-size: 22px;
            margin-bottom: 6px;
        }

        .feature-item .name {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .feature-item .price {
            font-size: 11px;
            color: var(--text-muted);
            margin-top: 2px;
        }

        /* Modal */
        .modal-backdrop {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.85);
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(8px);
        }

        .modal-backdrop.open {
            opacity: 1;
            pointer-events: auto;
        }

        .modal-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 36px;
            width: 400px;
            text-align: center;
            transform: scale(0.95);
            transition: transform 0.3s;
        }

        .modal-backdrop.open .modal-card {
            transform: scale(1);
        }

        /* Loader */
        .loader {
            width: 36px;
            height: 36px;
            border: 3px solid var(--border);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Keyboard Shortcut Badge */
        .kbd {
            display: inline-flex;
            padding: 3px 6px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            font-size: 10px;
            font-weight: 600;
            color: var(--text-muted);
            border: 1px solid var(--border);
        }

        /* Export Button */
        .export-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 12px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--text-secondary);
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 12px;
        }

        .export-btn:hover {
            background: var(--bg-primary);
            border-color: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
        }

        /* Valentine Week Mode Styles */
        .week-mode-bar {
            display: flex;
            gap: 8px;
            padding: 16px 12px;
            overflow-x: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .week-mode-bar::-webkit-scrollbar {
            display: none;
        }

        .week-day {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-width: 68px;
            padding: 12px 8px;
            border-radius: 14px;
            background: var(--bg-tertiary);
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .week-day::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), transparent);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .week-day:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            border-color: var(--border-glow);
            background: var(--bg-glass);
        }

        .week-day:hover::before {
            opacity: 1;
        }

        .week-day.active {
            background: linear-gradient(135deg, var(--accent), var(--accent-purple));
            color: white;
            font-weight: 600;
            box-shadow: 0 8px 25px rgba(244, 63, 94, 0.4);
            border-color: transparent;
            transform: scale(1.05);
        }

        .week-day .label {
            font-size: 11px;
            margin-top: 4px;
            opacity: 0.8;
            font-weight: 500;
            text-align: center;
            line-height: 1.2;
        }

        .week-day.active .label {
            opacity: 1;
            font-weight: 600;
        }

        /* Modern Theme Card Enhancements */
        .theme-card {
            position: relative;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .theme-card::after {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 16px;
            padding: 2px;
            background: linear-gradient(135deg, var(--accent), var(--accent-purple));
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask-composite: exclude;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .theme-card:hover {
            transform: translateY(-6px) scale(1.03);
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.25);
        }

        .theme-card:hover::after {
            opacity: 1;
        }

        .theme-card.active::after {
            opacity: 1;
        }
    </style>
</head>

<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const FEATURES = [
            { id: 'feature_gallery', icon: 'üì∏', label: 'Photo Gallery', price: 9 },
            { id: 'feature_music', icon: 'üéµ', label: 'Custom Music', price: 9 },
            { id: 'feature_timeline', icon: 'üìÖ', label: 'Love Timeline', price: 15 },
            { id: 'feature_quiz', icon: '‚ùì', label: 'Love Quiz', price: 9 },
            { id: 'feature_gift', icon: 'üéÅ', label: 'Virtual Gift', price: 15 },
            { id: 'feature_countdown', icon: '‚è≥', label: 'Countdown', price: 5 },
            { id: 'feature_password', icon: 'üîí', label: 'Password Lock', price: 5 },
            { id: 'feature_scratch', icon: '‚ú®', label: 'Scratch Card', price: 19 },
            { id: 'feature_spin', icon: 'üé°', label: 'Spin Wheel', price: 19 },
            { id: 'feature_memory', icon: 'üß†', label: 'Memory Game', price: 19 },
            { id: 'feature_video', icon: 'üé•', label: 'Video Message', price: 25 },
            { id: 'feature_confetti', icon: 'üéâ', label: 'Confetti Rain', price: 5 }
        ];





        const COLORS = [
            { id: 'rose', color: '#f43f5e', name: 'Rose' },
            { id: 'pink', color: '#ec4899', name: 'Pink' },
            { id: 'purple', color: '#a855f7', name: 'Purple' },
            { id: 'violet', color: '#8b5cf6', name: 'Violet' },
            { id: 'gold', color: '#f59e0b', name: 'Gold' },
            { id: 'red', color: '#ef4444', name: 'Red' }
        ];

        const FONTS = [
            { id: 'playfair', name: 'Playfair Display', preview: 'Romantic', style: 'serif' },
            { id: 'dancing', name: 'Dancing Script', preview: 'Elegant', style: 'cursive' },
            { id: 'inter', name: 'Inter', preview: 'Modern', style: 'sans-serif' },
            { id: 'cinzel', name: 'Cinzel', preview: 'Classic', style: 'serif' }
        ];

        const TEMPLATES = [
            {
                id: 'romantic', icon: 'üíï', name: 'Classic Romance',
                desc: 'Elegant and heartfelt',
                config: {
                    message: "My dearest love,\n\nEvery moment with you is a treasure. You are my everything.\n\nForever yours.",
                    theme: 'cosmic',
                    features: ['feature_gallery', 'feature_timeline', 'feature_music'],
                    timeline: [
                        { date: "When We Met", title: "Love at First Sight", description: "The moment our eyes met, I knew you were special." },
                        { date: "Our First Date", title: "Magic Happened", description: "Coffee, laughter, and endless conversation." },
                        { date: "Today", title: "Still Falling", description: "Every day I fall more in love with you." }
                    ]
                }
            },
            {
                id: 'playful', icon: 'üéâ', name: 'Playful & Fun',
                desc: 'Bright and energetic',
                config: {
                    message: "Hey you! üòä\n\nYou make every day an adventure. Let's create more memories together!\n\nLove you tons!",
                    theme: 'sakura',
                    features: ['feature_gallery', 'feature_quiz', 'feature_gift'],
                    quiz: { question: "What's my favorite thing about you?", options: ["Your smile", "Your laugh", "Your hugs", "Everything!"], correctIndex: 3 }
                }
            },
            {
                id: 'minimal', icon: '‚ú®', name: 'Elegant Minimal',
                desc: 'Clean and simple',
                config: {
                    message: "To my love,\n\nSimple words cannot express how I feel. You complete me.\n\nAlways.",
                    theme: 'minimal',
                    features: ['feature_gallery', 'feature_countdown']
                }
            },
            {
                id: 'poetic', icon: 'üìú', name: 'Poetic Soul',
                desc: 'Literary and deep',
                config: {
                    message: "My Beloved,\n\nLike the stars that paint the midnight sky, your love illuminates my world. In the garden of my heart, you are the most beautiful flower.\n\nEternally yours.",
                    theme: 'rose_garden',
                    features: ['feature_timeline', 'feature_music', 'feature_countdown'],
                    timeline: [
                        { date: "Chapter 1", title: "Destiny's Meeting", description: "Two souls destined to find each other." },
                        { date: "Chapter 2", title: "Growing Together", description: "Through every season, our love bloomed." },
                        { date: "Chapter 3", title: "Forever After", description: "The story continues, written by us." }
                    ]
                }
            },
            {
                id: 'cosmic', icon: 'ü™ê', name: 'Cosmic Adventure',
                desc: 'Dark mode with sparkles',
                config: {
                    message: "You are my universe,\n\nIn the vastness of space, I found you. My star, my moon, my everything.\n\nAcross galaxies, I'd find you again.",
                    theme: 'cosmic',
                    features: ['feature_gallery', 'feature_timeline', 'feature_quiz', 'feature_gift']
                }
            },
            {
                id: 'neon', icon: 'üíú', name: 'Cyberpunk Love',
                desc: 'Futuristic neon vibes',
                config: {
                    message: "[LOVE.EXE INITIATED]\n\nYou've hacked my heart.\nNo firewall can stop my feelings.\n\n[STATUS: FOREVER YOURS]",
                    theme: 'neon',
                    features: ['feature_gallery', 'feature_quiz', 'feature_gift', 'feature_password']
                }
            },
            {
                id: 'vintage', icon: 'üïØÔ∏è', name: 'Vintage Letter',
                desc: 'Old-fashioned charm',
                config: {
                    message: "My Dearest,\n\nIn this modern world, my love for you is timeless. Like letters of old, my feelings are penned with care.\n\nYours always.",
                    theme: 'vintage',
                    features: ['feature_gallery', 'feature_timeline']
                }
            },
            {
                id: 'v0_presentation', icon: 'üíé', name: 'v0 Modern Presentation',
                desc: 'Premium multi-section design',
                config: {
                    tagline: "To the love of my life",
                    message: "My dearest,\n\nYou are my sun, my moon, and all my stars. Every section of this page is a small piece of our beautiful story.\n\nEternally yours.",
                    theme: 'cosmic',
                    reasons: [
                        { title: "Your Smile", body: "It lights up my darkest days." },
                        { title: "Your Kindness", body: "The way you care for everyone." },
                        { title: "Your Support", body: "You are always there for me." },
                        { title: "Your Laugh", body: "The sweetest sound I've heard." },
                        { title: "Your Heart", body: "Generous, loving, and beautiful." },
                        { title: "Your Presence", body: "Simply being near you is enough." }
                    ],
                    timeline: [
                        { date: "Day We Met", title: "The Beginning", description: "The stars aligned." },
                        { date: "First Date", title: "Coffee & Talks", description: "Endless conversations." },
                        { date: "Today", title: "Still Falling", description: "I love you more than yesterday." }
                    ],
                    features: ['feature_gallery', 'feature_timeline', 'feature_confetti']
                }
            }
        ];

        const VALENTINE_WEEK = [
            { id: 'all', icon: '‚ù§Ô∏è', label: 'All Days' },
            { id: 'rose', icon: 'üåπ', label: 'Rose Day (Feb 7)', theme: 'rose_garden' },
            { id: 'propose', icon: 'üíç', label: 'Propose Day (Feb 8)', theme: 'minimal' },
            { id: 'chocolate', icon: 'üç´', label: 'Chocolate Day (Feb 9)', theme: 'vintage' },
            { id: 'teddy', icon: 'üß∏', label: 'Teddy Day (Feb 10)', theme: 'cloud' },
            { id: 'promise', icon: 'ü§ù', label: 'Promise Day (Feb 11)', theme: 'luxury' },
            { id: 'hug', icon: 'ü´Ç', label: 'Hug Day (Feb 12)', theme: 'polaroid' },
            { id: 'kiss', icon: 'üíã', label: 'Kiss Day (Feb 13)', theme: 'neon' },
            { id: 'valentine', icon: 'üíò', label: 'Valentine\'s Day (Feb 14)', theme: 'cosmic' }
        ];

        const THEMES = [
            // APP STYLES
            { id: 'music', template: 'universal', icon: 'üéµ', name: 'Melody (Spotify)', bg: '#1db954', desc: 'Music player style', config: { style: 'dark', primaryColor: '#1db954' }, tags: ['cool', 'modern'] },
            { id: 'stream', template: 'universal', icon: 'üé¨', name: 'Movie Night (Netflix)', bg: '#e50914', desc: 'Streaming service vibe', config: { style: 'dark', primaryColor: '#e50914' }, tags: ['cool', 'modern'] },
            { id: 'chat', template: 'universal', icon: 'üí¨', name: 'Love Chat', bg: '#25d366', desc: 'Messaging app style', config: { style: 'romantic', primaryColor: '#25d366' }, tags: ['modern', 'fun'] },
            { id: 'social', template: 'universal', icon: 'üì∏', name: 'InstaLove', bg: '#d62976', desc: 'Social feed style', config: { style: 'romantic', primaryColor: '#d62976' }, tags: ['modern', 'fun'] },

            // ROMANTIC STYLES
            { id: 'cosmic', template: 'universal', icon: 'ü™ê', name: 'Cosmic Love', bg: '#0f0c29', desc: 'Magical space particles', config: { style: 'cosmic' }, tags: ['romantic', 'dark'] },
            { id: 'rose_garden', template: 'universal', icon: 'üåπ', name: 'Rose Garden', bg: '#e11d48', desc: 'Falling petals & bloom', config: { style: 'romantic', primaryColor: '#e11d48' }, tags: ['romantic', 'rose'] },
            { id: 'vintage', template: 'universal', icon: 'üìú', name: 'Vintage Letter', bg: '#d4a373', desc: 'Old paper & nostalgia', config: { style: 'vintage' }, tags: ['classy', 'chocolate'] },
            { id: 'luxury', template: 'universal', icon: '‚ú®', name: 'Gold Luxury', bg: '#000000', desc: 'Black & Gold elegance', config: { style: 'dark', primaryColor: '#d4af37' }, tags: ['classy', 'promise'] },
            { id: 'cloud', template: 'universal', icon: '‚òÅÔ∏è', name: 'Lavender Haze', bg: '#a78bfa', desc: 'Soft clouds & dreams', config: { style: 'romantic', primaryColor: '#a78bfa' }, tags: ['cute', 'teddy'] },
            { id: 'sakura', template: 'universal', icon: 'üå∏', name: 'Sakura Season', bg: '#fbcfe8', desc: 'Japanese cherry blossoms', config: { style: 'romantic', primaryColor: '#fbcfe8' }, tags: ['romantic', 'cute'] },
            { id: 'pixel', template: 'universal', icon: 'üëæ', name: '8-Bit Heart', bg: '#3b82f6', desc: 'Retro gaming style', config: { style: 'dark', primaryColor: '#3b82f6' }, tags: ['fun', 'cool'] },
            { id: 'polaroid', template: 'universal', icon: 'üñºÔ∏è', name: 'Memory Wall', bg: '#fffbeb', desc: 'Polaroid gallery focus', config: { style: 'romantic' }, tags: ['photo', 'hug'] },
            { id: 'minimal', template: 'universal', icon: '‚ö™', name: 'Pure Minimal', bg: '#f3f4f6', desc: 'Clean & typographic', config: { style: 'romantic' }, tags: ['clean', 'propose'] },
            { id: 'nature', template: 'universal', icon: 'üåø', name: 'Enchanted Forest', bg: '#059669', desc: 'Fireflies & greenery', config: { style: 'dark', primaryColor: '#10b981' }, tags: ['nature'] },
            { id: 'ocean', template: 'universal', icon: 'üåä', name: 'Deep Ocean', bg: '#0891b2', desc: 'Underwater bubbles', config: { style: 'dark', primaryColor: '#06b6d4' }, tags: ['nature'] },
            { id: 'sunset', template: 'universal', icon: 'üåÖ', name: 'Sunset Blvd', bg: '#f97316', desc: 'Warm gradients', config: { style: 'romantic', primaryColor: '#f97316' }, tags: ['romantic'] },

            // NEW THEMES 2025
            { id: 'aurora', template: 'universal', icon: 'üåå', name: 'Aurora Dream', bg: 'linear-gradient(135deg, #0f172a, #22d3ee, #f472b6)', desc: 'Northern lights magic', config: { style: 'aurora' }, tags: ['romantic', 'magical', 'dark'] },
            { id: 'underwater', template: 'universal', icon: 'üê†', name: 'Underwater Love', bg: '#006994', desc: 'Deep sea romance', config: { style: 'dark', primaryColor: '#006994' }, tags: ['nature', 'calm', 'ocean'] },
            { id: 'galaxy', template: 'universal', icon: '‚ú®', name: 'Galaxy Lovers', bg: '#1a0033', desc: 'Swirling cosmos', config: { style: 'cosmic' }, tags: ['cosmic', 'dark', 'romantic'] },
            { id: 'meadow', template: 'universal', icon: 'üåº', name: 'Spring Meadow', bg: '#7cb342', desc: 'Blooming flowers', config: { style: 'romantic', primaryColor: '#84cc16' }, tags: ['nature', 'cheerful', 'spring'] },
            { id: 'citynight', template: 'universal', icon: 'üåÉ', name: 'City Lights', bg: '#1e1e2e', desc: 'Urban skyline romance', config: { style: 'dark', primaryColor: '#f59e0b' }, tags: ['modern', 'urban', 'dark'] },

            { id: 'neon', template: 'universal', icon: 'üíú', name: 'Cyberpunk', bg: '#7e22ce', desc: 'Futuristic neon', config: { style: 'dark', primaryColor: '#a855f7' }, tags: ['cool', 'kiss'] },
            { id: 'midnight', template: 'universal', icon: 'üåô', name: 'Midnight', bg: '#1e293b', desc: 'Dark & simple', config: { style: 'dark' }, tags: ['dark'] }
        ];

        function App() {
            const [activeSection, setActiveSection] = useState('themes');
            const [mode, setMode] = useState('desktop');
            const [orientation, setOrientation] = useState('portrait');
            const [loading, setLoading] = useState(true);
            const [orderData, setOrderData] = useState(null);
            const [selectedFeatures, setSelectedFeatures] = useState(['feature_gallery', 'feature_timeline']);
            const [currentTheme, setCurrentTheme] = useState('cosmic');
            const [accentColor, setAccentColor] = useState('rose');
            const [selectedFont, setSelectedFont] = useState('playfair');
            const [animationLevel, setAnimationLevel] = useState(2);

            // Pro Features State
            const [zoomLevel, setZoomLevel] = useState(100);
            const [soundEnabled, setSoundEnabled] = useState(true);
            const [autoSaveStatus, setAutoSaveStatus] = useState('saved');
            const [history, setHistory] = useState([]);
            const [historyIndex, setHistoryIndex] = useState(-1);

            // V16 Smart Features State
            const [aiModalOpen, setAiModalOpen] = useState(false);
            const [isRecording, setIsRecording] = useState(false);
            const [mediaRecorder, setMediaRecorder] = useState(null);

            // V17 UI State
            const [darkMode, setDarkMode] = useState(true);
            const [weekMode, setWeekMode] = useState('all'); // 'all', 'rose', 'propose', etc.

            // User Auth State
            const [currentUser, setCurrentUser] = useState(null);
            const [authModal, setAuthModal] = useState(null); // 'login' | 'register' | null
            const [authLoading, setAuthLoading] = useState(false);
            const [authError, setAuthError] = useState('');

            // My Orders State
            const [myOrders, setMyOrders] = useState([]);
            const [loadingOrders, setLoadingOrders] = useState(false);

            // Fetch Orders
            const fetchMyOrders = async () => {
                if (!currentUser) return;
                setLoadingOrders(true);
                try {
                    const res = await fetch('/api/my-orders', { credentials: 'include' });
                    const data = await res.json();
                    setMyOrders(Array.isArray(data) ? data : []);
                } catch (e) { console.error(e); }
                setLoadingOrders(false);
            };

            useEffect(() => {
                if (activeSection === 'orders') {
                    fetchMyOrders();
                }
            }, [activeSection, currentUser]);

            // Check if user is logged in on load
            useEffect(() => {
                fetch('/api/auth/me', { credentials: 'include' })
                    .then(r => r.json())
                    .then(data => {
                        if (data.success) setCurrentUser(data.user);
                    })
                    .catch(() => { });
            }, []);

            // Login function
            const handleLogin = async (email, password) => {
                setAuthLoading(true);
                setAuthError('');
                try {
                    const res = await fetch('/api/auth/login', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        credentials: 'include',
                        body: JSON.stringify({ email, password })
                    });
                    const data = await res.json();
                    if (data.success) {
                        setCurrentUser(data.user);
                        setAuthModal(null);
                    } else {
                        setAuthError(data.error || 'Login failed');
                    }
                } catch (e) {
                    setAuthError('Login failed');
                }
                setAuthLoading(false);
            };

            // Register function
            const handleRegister = async (name, email, password) => {
                setAuthLoading(true);
                setAuthError('');
                try {
                    const res = await fetch('/api/auth/register', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        credentials: 'include',
                        body: JSON.stringify({ name, email, password })
                    });
                    const data = await res.json();
                    if (data.success) {
                        setCurrentUser(data.user);
                        setAuthModal(null);
                    } else {
                        setAuthError(data.error || 'Registration failed');
                    }
                } catch (e) {
                    setAuthError('Registration failed');
                }
                setAuthLoading(false);
            };

            // Logout function
            const handleLogout = async () => {
                await fetch('/api/auth/logout', { method: 'POST', credentials: 'include' });
                setCurrentUser(null);
            };

            // Calculate progress
            const calculateProgress = () => {
                let filled = 0;
                let total = 6;
                if (config.partnerName) filled++;
                if (config.senderName) filled++;
                if (config.message.length > 20) filled++;
                if (config.gallery.length > 0) filled++;
                if (config.timeline.length > 0) filled++;
                if (selectedFeatures.length > 0) filled++;
                return Math.round((filled / total) * 100);
            };


            const generateLoveLetter = (mood) => {
                const name = config.partnerName || 'my love';
                const sender = config.senderName || 'Me';

                const data = {
                    romantic: {
                        tagline: "To the rhythm of my heartbeat",
                        message: `My dearest ${name},\n\nEvery day with you feels like a dream I never want to wake up from. You are the beat in my heart and the light in my life.\n\nForever yours,\n${sender}`,
                        reasons: [
                            { title: "Your Soul", body: "Pure, kind, and absolutely beautiful." },
                            { title: "The Way You Look At Me", body: "It makes me feel like the luckiest person alive." },
                            { title: "Your Kindness", body: "You care for everyone with such grace." },
                            { title: "Our Long Talks", body: "Time stops when I am with you." },
                            { title: "Your Strength", body: "You inspire me to be better every single day." },
                            { title: "Your Laugh", body: "The soundtrack to my happiest moments." }
                        ]
                    },
                    funny: {
                        tagline: "My favorite weirdo",
                        message: `Hey ${name}!\n\nI love you more than pizza (and that's saying a lot!). Thanks for putting up with my bad jokes and stealing my hoodies.\n\nLove,\n${sender}`,
                        reasons: [
                            { title: "Hoodie Thief", body: "You look better in my clothes anyway." },
                            { title: "Terrible Singer", body: "I still love your car concerts." },
                            { title: "Bad Jokes", body: "Someone has to laugh at mine." },
                            { title: "Shared Pizzas", body: "Even if you steal the last slice." },
                            { title: "Video Game Rival", body: "I let you win... sometimes." },
                            { title: "The Weirdness", body: "Thank God I found someone as weird as me." }
                        ]
                    },
                    poetic: {
                        tagline: "A soul's eternal destiny",
                        message: `To ${name},\n\nLike the stars guide the night, your love guides my soul. In this vast universe, finding you was my greatest destiny.\n\nEternally,\n${sender}`,
                        reasons: [
                            { title: "Starlight", body: "Your love illuminates my darkest paths." },
                            { title: "Eternity", body: "A thousand lifetimes wouldn't be enough." },
                            { title: "The Universe", body: "It conspired to bring our souls together." },
                            { title: "Poetry in Motion", body: "Everything you do is a masterpiece." },
                            { title: "Silence", body: "Even our quiet moments speak volumes." },
                            { title: "The Future", body: "A canvas waiting for our colors." }
                        ]
                    },
                    short: {
                        tagline: "Simply everything",
                        message: `${name}, you make my heart smile. Happy Valentine's Day! ‚ù§Ô∏è\n\n- ${sender}`,
                        reasons: [
                            { title: "Everything", body: "You are the reason for my happiness." },
                            { title: "Smiles", body: "You bring them out so easily." },
                            { title: "Warmth", body: "Your love is my favorite place." },
                            { title: "Beauty", body: "Inside and out, you are perfect." },
                            { title: "Home", body: "With you, I am always where I belong." },
                            { title: "Always", body: "My heart is yours, forever." }
                        ]
                    }
                };

                const selectedData = data[mood];
                setConfig({
                    ...config,
                    tagline: selectedData.tagline,
                    message: selectedData.message,
                    reasons: selectedData.reasons
                });
                setAiModalOpen(false);
                setAutoSaveStatus('saved');
            };

            const toggleRecording = async () => {
                if (isRecording) {
                    mediaRecorder?.stop();
                    setIsRecording(false);
                } else {
                    try {
                        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                        const recorder = new MediaRecorder(stream);
                        const chunks = [];
                        recorder.ondataavailable = e => chunks.push(e.data);
                        recorder.onstop = () => {
                            const blob = new Blob(chunks, { type: 'audio/mp3' });
                            const reader = new FileReader();
                            reader.onload = (e) => {
                                setConfig({ ...config, musicUrl: e.target.result });
                                setAutoSaveStatus('saved');
                            };
                            reader.readAsDataURL(blob);
                            stream.getTracks().forEach(track => track.stop());
                        };
                        recorder.start();
                        setMediaRecorder(recorder);
                        setIsRecording(true);
                    } catch (e) { alert("Microphone access denied or not supported."); }
                }
            };


            const [config, setConfig] = useState({
                senderName: '', partnerName: '', tagline: 'To the love of my life', message: 'Every moment with you is magic...',
                musicUrl: 'https://res.cloudinary.com/dncywqfpb/video/upload/v1738399057/music_qzh0xk.mp3',
                giftUrl: 'https://images.unsplash.com/photo-1549465220-1a8b9238cd48',
                reasons: [
                    { title: "Your Smile", body: "It lights up my darkest days." },
                    { title: "Your Kindness", body: "The way you care for everyone." },
                    { title: "Your Support", body: "You are always there for me." },
                    { title: "Your Laugh", body: "The sweetest sound I've heard." },
                    { title: "Your Heart", body: "Generous, loving, and beautiful." },
                    { title: "Your Presence", body: "Simply being near you is enough." }
                ],
                timeline: [
                    { date: "Day We Met", title: "The Beginning", description: "The stars aligned." },
                    { date: "First Date", title: "Coffee & Talks", description: "Endless conversations." }
                ],
                quiz: { question: "Where was our first date?", options: ["Cafe", "Park", "Cinema", "Beach"], correctIndex: 0 },
                gallery: [
                    "https://images.unsplash.com/photo-1518199266791-5375a83190b7",
                    "https://images.unsplash.com/photo-1516589178581-6cd7833ae3b2",
                    "https://images.unsplash.com/photo-1529333166437-7750a6dd5a70"
                ],
                countdown: { enabled: false, date: "2026-02-14" },
                password: "",
                effects: { hearts: false, sparkles: false, bubbles: false }
            });

            const [deviceFrame, setDeviceFrame] = useState('iphone');

            const iframeRef = useRef(null);
            const baseUrl = window.location.origin;
            // Universal Theme Logic: Map themes to 'universal' template if specified
            const themeDef = THEMES.find(t => t.id === currentTheme);
            const templateDir = themeDef?.template || currentTheme;
            const previewUrl = `${baseUrl}/templates/${templateDir}/index.html`;
            const qrCodeUrl = `https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(previewUrl)}`;

            useEffect(() => {
                const send = () => iframeRef.current?.contentWindow?.postMessage({
                    type: 'UPDATE_CONFIG',
                    payload: {
                        ...config,
                        features: selectedFeatures,
                        accentColor: COLORS.find(c => c.id === accentColor)?.color,
                        fontFamily: FONTS.find(f => f.id === selectedFont)?.name,
                        animationLevel
                    }
                }, '*');
                send();
                const interval = setInterval(send, 2000);
                return () => clearInterval(interval);
            }, [config, selectedFeatures, accentColor, selectedFont, animationLevel]);

            // Keyboard shortcuts
            useEffect(() => {
                const handleKeyDown = (e) => {
                    if (e.metaKey || e.ctrlKey) {
                        if (e.key === 'p') { e.preventDefault(); setMode(m => m === 'desktop' ? 'mobile' : 'desktop'); }
                        if (e.key === 's') { e.preventDefault(); handleCheckout(); }
                    }
                };
                window.addEventListener('keydown', handleKeyDown);
                return () => window.removeEventListener('keydown', handleKeyDown);
            }, []);

            const themePrice = 20;
            const featurePrice = selectedFeatures.reduce((sum, fid) => (FEATURES.find(f => f.id === fid)?.price || 0) + sum, 0);
            const totalPrice = themePrice + featurePrice;

            // UPI Payment State
            const [upiModal, setUpiModal] = useState(null);

            const handleCheckout = async () => {
                confetti({ particleCount: 150, spread: 80, origin: { y: 0.6 }, colors: ['#f43f5e', '#a855f7', '#fb7185'] });
                try {
                    const res = await fetch('/api/create-order', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            features: selectedFeatures,
                            theme: currentTheme,
                            config: config,
                            customerName: config.senderName || 'Guest',
                            customerEmail: ''
                        })
                    });
                    const data = await res.json();
                    if (data.orderId) {
                        setUpiModal(data); // Show UPI payment modal
                    } else {
                        alert('Order failed. Please try again.');
                    }
                } catch (e) {
                    console.error(e);
                    alert('Order failed. Please try again.');
                }
            };

            const confirmPayment = async (transactionId) => {
                try {
                    const res = await fetch('/api/confirm-payment', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            orderId: upiModal.orderId,
                            transactionId,
                            config // Send config for when admin verifies
                        })
                    });
                    const data = await res.json();
                    if (data.success) {
                        // Check if it's pending verification or already verified
                        if (data.status === 'pending_verification') {
                            setOrderData({
                                orderId: data.orderId,
                                pending: true,
                                message: data.message
                            });
                        } else {
                            setOrderData({
                                orderId: data.orderId,
                                valentineId: data.valentineId,
                                shareUrl: data.shareUrl,
                                success: true
                            });
                        }
                        setUpiModal(null);
                    } else {
                        alert(data.error || 'Confirmation failed');
                    }
                } catch (e) {
                    alert('Confirmation failed. Please try again.');
                }
            };



            const toggleFeature = (id) => setSelectedFeatures(prev => prev.includes(id) ? prev.filter(f => f !== id) : [...prev, id]);
            const updateTimeline = (i, field, val) => { const t = [...config.timeline]; t[i][field] = val; setConfig({ ...config, timeline: t }); };
            const updateReason = (i, field, val) => { const r = [...config.reasons]; r[i][field] = val; setConfig({ ...config, reasons: r }); };
            const updateGallery = (i, val) => { const g = [...config.gallery]; g[i] = val; setConfig({ ...config, gallery: g }); };

            // Enhanced applyTemplate - applies theme, features, and config
            const applyTemplate = (template) => {
                const { theme, features, ...restConfig } = template.config;
                if (theme) setCurrentTheme(theme);
                if (features) setSelectedFeatures(features);
                setConfig({ ...config, ...restConfig });
                setAutoSaveStatus('saving');
                setTimeout(() => setAutoSaveStatus('saved'), 1000);
            };

            // File Upload Handlers
            const handlePhotoUpload = (e, index) => {
                const file = e.target.files[0];
                if (!file) return;
                const reader = new FileReader();
                reader.onload = (event) => {
                    const newGallery = [...config.gallery];
                    if (index !== undefined) {
                        newGallery[index] = event.target.result;
                    } else {
                        newGallery.push(event.target.result);
                    }
                    setConfig({ ...config, gallery: newGallery });
                    setAutoSaveStatus('saving');
                    setTimeout(() => setAutoSaveStatus('saved'), 500);
                };
                reader.readAsDataURL(file);
            };

            const handleMusicUpload = (e) => {
                const file = e.target.files[0];
                if (!file) return;
                const reader = new FileReader();
                reader.onload = (event) => {
                    setConfig({ ...config, musicUrl: event.target.result });
                    setAutoSaveStatus('saving');
                    setTimeout(() => setAutoSaveStatus('saved'), 500);
                };
                reader.readAsDataURL(file);
            };

            const handleGiftUpload = (e) => {
                const file = e.target.files[0];
                if (!file) return;
                const reader = new FileReader();
                reader.onload = (event) => {
                    setConfig({ ...config, giftUrl: event.target.result });
                    setAutoSaveStatus('saving');
                    setTimeout(() => setAutoSaveStatus('saved'), 500);
                };
                reader.readAsDataURL(file);
            };

            const addGallerySlot = () => {
                setConfig({ ...config, gallery: [...config.gallery, ''] });
            };

            const removeGalleryImage = (index) => {
                const newGallery = config.gallery.filter((_, i) => i !== index);
                setConfig({ ...config, gallery: newGallery });
            };


            return (
                <div className={`app-layout ${!activeSection ? 'panel-closed' : ''}`} data-theme={darkMode ? 'dark' : 'light'}>
                    {/* Gradient Mesh Background */}
                    <div className="gradient-mesh"></div>

                    {/* Progress Bar */}
                    <div className="progress-bar">
                        <div className="progress-fill" style={{ width: `${calculateProgress()}%` }}></div>
                    </div>

                    {/* SIDEBAR */}
                    <div className="sidebar">
                        <div className="sidebar-logo">üíò</div>

                        {/* User Account Button */}
                        {currentUser ? (
                            <div
                                className="sidebar-item"
                                data-tooltip={currentUser.name}
                                onClick={() => {
                                    if (confirm(`Logged in as ${currentUser.email}\n\nLogout?`)) {
                                        handleLogout();
                                    }
                                }}
                                style={{ background: 'linear-gradient(135deg, var(--accent), var(--accent-purple))', color: 'white' }}
                            >
                                {currentUser.name.charAt(0).toUpperCase()}
                            </div>
                        ) : (
                            <div
                                className="sidebar-item"
                                data-tooltip="Login / Sign Up"
                                onClick={() => setAuthModal('login')}
                            >
                                üë§
                            </div>
                        )}

                        <div className="sidebar-divider"></div>
                        <div className={`sidebar-item ${activeSection === 'orders' ? 'active' : ''}`} data-tooltip="My Gifts" onClick={() => setActiveSection('orders')}>üéÅ</div>
                        <div className={`sidebar-item ${activeSection === 'themes' ? 'active' : ''}`} data-tooltip="Themes" onClick={() => setActiveSection('themes')}>üé®</div>
                        <div className={`sidebar-item ${activeSection === 'content' ? 'active' : ''}`} data-tooltip="Content" onClick={() => setActiveSection('content')}>‚úçÔ∏è</div>
                        <div className={`sidebar-item ${activeSection === 'features' ? 'active' : ''}`} data-tooltip="Features" onClick={() => setActiveSection('features')}>‚ú®</div>
                        <div className={`sidebar-item ${activeSection === 'gallery' ? 'active' : ''}`} data-tooltip="Gallery" onClick={() => setActiveSection('gallery')}>üì∏</div>
                        <div className={`sidebar-item ${activeSection === 'timeline' ? 'active' : ''}`} data-tooltip="Timeline" onClick={() => setActiveSection('timeline')}>üìÖ</div>
                        <div className="sidebar-divider"></div>
                        <div className={`sidebar-item ${activeSection === 'style' ? 'active' : ''}`} data-tooltip="Style" onClick={() => setActiveSection('style')}>üé≠</div>
                        <div className={`sidebar-item ${activeSection === 'templates' ? 'active' : ''}`} data-tooltip="Templates" onClick={() => setActiveSection('templates')}>üìã</div>
                        <div className={`sidebar-item ${activeSection === 'settings' ? 'active' : ''}`} data-tooltip="Settings" onClick={() => setActiveSection('settings')}>‚öôÔ∏è</div>


                        {/* WEEK MODE SELECTOR (New) */}
                        <div className="week-mode-bar">
                            {VALENTINE_WEEK.map(day => (
                                <div
                                    key={day.id}
                                    className={`week-day ${weekMode === day.id ? 'active' : ''}`}
                                    onClick={() => {
                                        setWeekMode(day.id);
                                        if (day.theme && day.id !== 'all') setCurrentTheme(day.theme);
                                        // Set default message for the day
                                        if (day.id !== 'all') {
                                            const name = config.partnerName || 'Love';
                                            setConfig(prev => ({ ...prev, message: `Happy ${day.label.split('(')[0].trim()} ${name}! ‚ù§Ô∏è` }));
                                        }
                                    }}
                                    title={day.label}
                                >
                                    <span style={{ fontSize: 16 }}>{day.icon}</span>
                                    <span className="label">{day.label.split(' ')[0]}</span>
                                </div>
                            ))}
                        </div>
                        <div className="sidebar-spacer"></div>
                        <div className="sidebar-item" data-tooltip={darkMode ? 'Light Mode' : 'Dark Mode'} onClick={() => setDarkMode(!darkMode)}>{darkMode ? 'üåô' : '‚òÄÔ∏è'}</div>
                        <div className="sidebar-item" data-tooltip="Shortcuts" onClick={() => alert('‚åòP: Preview Mode\n‚åòS: Publish')}>‚å®Ô∏è</div>
                    </div>


                    {/* CANVAS */}
                    <div className="canvas-area">
                        <div className="canvas-pattern"></div>
                        <div className="toolbar">
                            <button className={`toolbar-btn ${mode === 'desktop' ? 'active' : ''}`} onClick={() => setMode('desktop')}>Desktop</button>
                            <button className={`toolbar-btn ${mode === 'mobile' ? 'active' : ''}`} onClick={() => setMode('mobile')}>Mobile</button>
                            {mode === 'mobile' && (
                                <>
                                    <div className="toolbar-divider"></div>
                                    <button className={`toolbar-btn ${orientation === 'portrait' ? 'active' : ''}`} onClick={() => setOrientation('portrait')}>Portrait</button>
                                    <button className={`toolbar-btn ${orientation === 'landscape' ? 'active' : ''}`} onClick={() => setOrientation('landscape')}>Landscape</button>
                                </>
                            )}
                            <div className="toolbar-divider"></div>
                            <button className="toolbar-btn" onClick={() => setZoomLevel(Math.max(50, zoomLevel - 25))}>‚ûñ</button>
                            <span style={{ fontSize: '12px', color: '#a1a1aa', minWidth: '45px', textAlign: 'center' }}>{zoomLevel}%</span>
                            <button className="toolbar-btn" onClick={() => setZoomLevel(Math.min(150, zoomLevel + 25))}>‚ûï</button>
                            <div className="toolbar-divider"></div>
                            <button className={`toolbar-btn ${soundEnabled ? 'active' : ''}`} onClick={() => setSoundEnabled(!soundEnabled)} title="Sound Effects">{soundEnabled ? 'üîä' : 'üîá'}</button>
                            <div style={{ marginLeft: 'auto', display: 'flex', alignItems: 'center', gap: '8px' }}>
                                <span style={{ fontSize: '11px', color: autoSaveStatus === 'saved' ? '#22c55e' : '#f59e0b' }}>{autoSaveStatus === 'saved' ? '‚úì Saved' : '‚óè Saving...'}</span>
                            </div>
                        </div>

                        <div className="preview-container">
                            {mode === 'desktop' ? (
                                <div className="preview-desktop">
                                    {loading && <div style={{ position: 'absolute', inset: 0, background: '#09090b', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 5 }}><span className="loader"></span></div>}
                                    <iframe ref={iframeRef} src={previewUrl} style={{ width: '100%', height: '100%', border: 'none' }} onLoad={() => setTimeout(() => setLoading(false), 500)}></iframe>
                                </div>
                            ) : (
                                <div className={`preview-mobile ${orientation === 'landscape' ? 'landscape' : ''}`}>
                                    <div className="preview-screen">
                                        {orientation === 'portrait' && <div className="notch"></div>}
                                        {loading && <div style={{ position: 'absolute', inset: 0, background: '#09090b', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 5 }}><span className="loader"></span></div>}
                                        <iframe ref={iframeRef} src={previewUrl} style={{ width: '100%', height: '100%', border: 'none' }} onLoad={() => setTimeout(() => setLoading(false), 500)}></iframe>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>

                    {/* RIGHT PANEL */}
                    {
                        activeSection && (
                            <div className="right-panel">
                                <div className="panel-header">
                                    <div>
                                        <div className="panel-title">
                                            {activeSection === 'orders' && 'üéÅ My Valentines'}
                                            {activeSection === 'themes' && 'üé® Choose Theme'}
                                            {activeSection === 'content' && '‚úçÔ∏è Edit Content'}
                                            {activeSection === 'features' && '‚ú® Add Features'}
                                            {activeSection === 'gallery' && 'üì∏ Photo Gallery'}
                                            {activeSection === 'timeline' && 'üìÖ Our Story'}
                                            {activeSection === 'style' && 'üé≠ Customize Style'}
                                            {activeSection === 'templates' && 'üìã Quick Templates'}
                                            {activeSection === 'settings' && '‚öôÔ∏è Settings'}
                                        </div>
                                        <div className="panel-subtitle">
                                            {activeSection === 'orders' && 'Your purchase history & links'}
                                            {activeSection === 'themes' && `${THEMES.length} beautiful themes`}
                                            {activeSection === 'style' && 'Colors, fonts & animations'}
                                            {activeSection === 'templates' && 'One-click setup'}
                                        </div>
                                    </div>
                                    <button className="panel-close" onClick={() => setActiveSection(null)}>‚úï</button>
                                </div>
                                <div className="panel-body">

                                    {/* MY ORDERS SECTION */}
                                    {activeSection === 'orders' && (
                                        <div className="orders-list" style={{ display: 'flex', flexDirection: 'column', gap: 12 }}>
                                            {!currentUser ? (
                                                <div style={{ textAlign: 'center', padding: 40, color: 'var(--text-muted)' }}>
                                                    <div style={{ fontSize: 40, marginBottom: 10 }}>üîí</div>
                                                    <p>Please login to view your gifts.</p>
                                                    <button className="btn-primary" onClick={() => setAuthModal('login')} style={{ marginTop: 20 }}>Login</button>
                                                </div>
                                            ) : loadingOrders ? (
                                                <div style={{ display: 'flex', justifyContent: 'center', padding: 40 }}><span className="loader"></span></div>
                                            ) : myOrders.length === 0 ? (
                                                <div style={{ textAlign: 'center', padding: 40, color: 'var(--text-muted)' }}>
                                                    <div style={{ fontSize: 40, marginBottom: 10 }}>üíù</div>
                                                    <p>You haven't created any valentines yet.</p>
                                                    <button className="btn-primary" onClick={() => setActiveSection('themes')} style={{ marginTop: 20 }}>Create One Now</button>
                                                </div>
                                            ) : (
                                                myOrders.map(order => (
                                                    <div key={order.orderId} className="card" style={{ padding: 16, border: order.status === 'paid' ? '1px solid var(--accent)' : '1px solid var(--border)' }}>
                                                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: 8 }}>
                                                            <div style={{ fontWeight: 600, color: 'white' }}>{order.config?.partnerName || 'Valentine'}</div>
                                                            <span style={{
                                                                fontSize: 10, padding: '4px 8px', borderRadius: 10,
                                                                background: order.status === 'paid' ? '#22c55e' : (order.status === 'awaiting_verification' ? '#f59e0b' : '#ef4444'),
                                                                color: '#000'
                                                            }}>
                                                                {order.status === 'paid' ? 'Active' : (order.status === 'awaiting_verification' ? 'Pending' : 'Unpaid')}
                                                            </span>
                                                        </div>
                                                        <div style={{ fontSize: 12, color: 'var(--text-muted)', marginBottom: 12 }}>
                                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                <span>To: {order.config?.partnerName || 'My Love'}</span>
                                                                <span>‚Çπ{order.amount}</span>
                                                            </div>
                                                            Theme: {THEMES.find(t => t.id === order.theme)?.name || order.theme}<br />
                                                            Date: {new Date(order.createdAt).toLocaleDateString()}
                                                        </div>

                                                        {order.status === 'paid' && order.valentineId && (
                                                            <div style={{ display: 'flex', gap: 8 }}>
                                                                <button className="btn-secondary" style={{ flex: 1, fontSize: 12 }} onClick={() => window.open(`/v/${order.valentineId}`, '_blank')}>View</button>
                                                                <button className="btn-secondary" style={{ flex: 1, fontSize: 12 }} onClick={() => { navigator.clipboard.writeText(`${window.location.origin}/v/${order.valentineId}`); alert('Link copied!'); }}>Copy Link</button>
                                                            </div>
                                                        )}

                                                        {order.status === 'awaiting_verification' && (
                                                            <button
                                                                className="btn-secondary"
                                                                style={{ width: '100%', fontSize: 12, color: '#f59e0b' }}
                                                                onClick={() => window.open(`https://wa.me/918709157822?text=Hi! checking status for Order: ${order.orderId}`, '_blank')}
                                                            >
                                                                ‚è≥ Check Status on WhatsApp
                                                            </button>
                                                        )}

                                                        {order.status === 'pending' && (
                                                            <div style={{ fontSize: 11, color: '#ef4444', textAlign: 'center' }}>Payment not completed</div>
                                                        )}
                                                    </div>
                                                ))
                                            )}
                                        </div>
                                    )}

                                    {/* THEMES SECTION */}
                                    {activeSection === 'themes' && (
                                        <div className="theme-grid">
                                            {THEMES.filter(t => weekMode === 'all' || t.tags?.includes(weekMode) || t.id === VALENTINE_WEEK.find(d => d.id === weekMode)?.theme).map(theme => (
                                                <div key={theme.id} className={`theme-card ${currentTheme === theme.id ? 'active' : ''}`} onClick={() => setCurrentTheme(theme.id)}>
                                                    <div className="theme-card-bg" style={{ background: theme.bg }}></div>
                                                    <div className="theme-card-info">
                                                        <span className="theme-card-name">{theme.icon} {theme.name}</span>
                                                    </div>
                                                    {currentTheme === theme.id && <div className="theme-card-badge">Active</div>}
                                                </div>
                                            ))}
                                        </div>
                                    )}

                                    {/* CONTENT SECTION */}
                                    {activeSection === 'content' && (
                                        <>
                                            <div className="form-group">
                                                <label className="form-label">‚ù§Ô∏è Partner's Name</label>
                                                <input className="form-input" value={config.partnerName} onChange={e => setConfig({ ...config, partnerName: e.target.value })} placeholder="Their name" />
                                            </div>
                                            <div className="form-group">
                                                <label className="form-label">‚ú® Romantic Tagline</label>
                                                <input className="form-input" value={config.tagline} onChange={e => setConfig({ ...config, tagline: e.target.value })} placeholder="Short tagline" />
                                            </div>
                                            <div className="form-group">
                                                <label className="form-label">üíå Your Name</label>
                                                <input className="form-input" value={config.senderName} onChange={e => setConfig({ ...config, senderName: e.target.value })} placeholder="Your name" />
                                            </div>
                                            <div className="form-group">
                                                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 10 }}>
                                                    <label className="form-label" style={{ margin: 0 }}>üíï Love Letter</label>
                                                    <button onClick={() => setAiModalOpen(true)} style={{ fontSize: 12, padding: '6px 14px', background: 'linear-gradient(135deg,#6366f1,#a855f7)', color: 'white', border: 'none', borderRadius: 8, cursor: 'pointer', fontWeight: 600 }}>‚ú® AI Magic Write</button>
                                                </div>
                                                <textarea className="form-input form-textarea" value={config.message} onChange={e => setConfig({ ...config, message: e.target.value })}></textarea>
                                            </div>

                                            <div style={{ marginTop: 20 }}>
                                                <label className="form-label">üíñ Reasons I Love You</label>
                                                <div style={{ display: 'flex', flexDirection: 'column', gap: 12 }}>
                                                    {config.reasons.map((reason, i) => (
                                                        <div key={i} className="card" style={{ padding: 12 }}>
                                                            <input className="form-input" style={{ marginBottom: 8, fontSize: 13, fontWeight: 600 }} value={reason.title} onChange={e => updateReason(i, 'title', e.target.value)} placeholder="Title" />
                                                            <textarea className="form-input" style={{ fontSize: 12, minHeight: 40 }} value={reason.body} onChange={e => updateReason(i, 'body', e.target.value)} placeholder="Why?"></textarea>
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>
                                        </>
                                    )}

                                    {/* FEATURES SECTION */}
                                    {activeSection === 'features' && (
                                        <>
                                            <p style={{ fontSize: 13, color: 'var(--text-muted)', marginBottom: 20 }}>Select features to include in your Valentine's page.</p>
                                            <div className="feature-grid">
                                                {FEATURES.map(f => (
                                                    <div key={f.id} className={`feature-item ${selectedFeatures.includes(f.id) ? 'active' : ''}`} onClick={() => toggleFeature(f.id)}>
                                                        <div className="icon">{f.icon}</div>
                                                        <div className="name">{f.label}</div>
                                                        <div className="price">‚Çπ{f.price}</div>
                                                    </div>
                                                ))}
                                            </div>

                                            {/* Music Upload */}
                                            {selectedFeatures.includes('feature_music') && (
                                                <div className="card" style={{ marginTop: 20, padding: 16 }}>
                                                    <div className="form-label">üéµ Background Music</div>
                                                    <input className="form-input" style={{ marginBottom: 10 }} value={config.musicUrl} onChange={(e) => setConfig({ ...config, musicUrl: e.target.value })} placeholder="Paste music URL..." />
                                                    <div style={{ display: 'flex', gap: 10 }}>
                                                        <label style={{ flex: 1, display: 'flex', alignItems: 'center', justifyContent: 'center', gap: 8, padding: '12px', background: 'var(--bg-primary)', border: '1px dashed var(--border)', borderRadius: 10, cursor: 'pointer', color: 'var(--accent)', fontSize: 12 }}>
                                                            <input type="file" accept="audio/*" style={{ display: 'none' }} onChange={handleMusicUpload} />
                                                            üì§ Upload
                                                        </label>
                                                        <button onClick={toggleRecording} style={{ flex: 1, display: 'flex', alignItems: 'center', justifyContent: 'center', gap: 8, padding: '12px', background: isRecording ? '#ef4444' : 'var(--bg-primary)', border: '1px solid var(--border)', borderRadius: 10, cursor: 'pointer', color: isRecording ? 'white' : 'var(--accent)', fontSize: 12 }}>
                                                            {isRecording ? '‚èπ Stop' : 'üé§ Record Voice'}
                                                        </button>
                                                    </div>
                                                    {config.musicUrl && config.musicUrl.startsWith('data:') && <p style={{ fontSize: 11, color: '#22c55e', marginTop: 8 }}>‚úì Audio loaded</p>}
                                                </div>
                                            )}

                                            {/* Gift Upload */}
                                            {selectedFeatures.includes('feature_gift') && (
                                                <div className="card" style={{ marginTop: 12, padding: 16 }}>
                                                    <div className="form-label">üéÅ Gift Image</div>
                                                    <input className="form-input" style={{ marginBottom: 10 }} value={config.giftUrl} onChange={(e) => setConfig({ ...config, giftUrl: e.target.value })} placeholder="Paste gift image URL..." />
                                                    <label style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: 8, padding: '12px 16px', background: 'var(--bg-primary)', border: '1px dashed var(--border)', borderRadius: 10, cursor: 'pointer', color: 'var(--accent)', fontSize: 13 }}>
                                                        <input type="file" accept="image/*" style={{ display: 'none' }} onChange={handleGiftUpload} />
                                                        üì§ Upload Gift Image
                                                    </label>
                                                    {config.giftUrl && <div style={{ marginTop: 10, borderRadius: 10, overflow: 'hidden', maxWidth: 120 }}><img src={config.giftUrl} style={{ width: '100%', height: 80, objectFit: 'cover' }} /></div>}
                                                </div>
                                            )}
                                        </>
                                    )}


                                    {/* GALLERY SECTION */}
                                    {activeSection === 'gallery' && (
                                        <div style={{ display: 'flex', flexDirection: 'column', gap: 12 }}>
                                            <p style={{ fontSize: 12, color: 'var(--text-muted)', marginBottom: 8 }}>Upload photos from your device or paste URLs</p>
                                            {config.gallery.map((url, i) => (
                                                <div key={i} className="card" style={{ display: 'flex', gap: 12, alignItems: 'center', padding: 12 }}>
                                                    <div style={{ width: 60, height: 60, borderRadius: 10, background: '#1a1a1a', overflow: 'hidden', flexShrink: 0, position: 'relative' }}>
                                                        {url && <img src={url} style={{ width: '100%', height: '100%', objectFit: 'cover' }} />}
                                                        {!url && <span style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', height: '100%', color: 'var(--text-muted)', fontSize: 20 }}>üì∑</span>}
                                                    </div>
                                                    <div style={{ flex: 1, display: 'flex', flexDirection: 'column', gap: 6 }}>
                                                        <input className="form-input" style={{ marginBottom: 0, fontSize: 12 }} value={url} onChange={e => updateGallery(i, e.target.value)} placeholder="Paste image URL..." />
                                                        <label style={{ display: 'flex', alignItems: 'center', gap: 6, fontSize: 11, color: 'var(--accent)', cursor: 'pointer' }}>
                                                            <input type="file" accept="image/*" style={{ display: 'none' }} onChange={(e) => handlePhotoUpload(e, i)} />
                                                            üì§ Upload from device
                                                        </label>
                                                    </div>
                                                    <button style={{ width: 32, height: 32, borderRadius: 8, background: 'transparent', border: '1px solid var(--border)', color: '#ef4444', cursor: 'pointer', fontSize: 16 }} onClick={() => removeGalleryImage(i)}>√ó</button>
                                                </div>
                                            ))}
                                            <div style={{ display: 'flex', gap: 10 }}>
                                                <button className="btn-secondary" style={{ flex: 1 }} onClick={addGallerySlot}>+ Add Photo Slot</button>
                                                <label className="btn-secondary" style={{ flex: 1, display: 'flex', alignItems: 'center', justifyContent: 'center', cursor: 'pointer' }}>
                                                    <input type="file" accept="image/*" style={{ display: 'none' }} onChange={(e) => handlePhotoUpload(e)} />
                                                    üì§ Upload New
                                                </label>
                                            </div>
                                        </div>
                                    )}


                                    {/* TIMELINE SECTION */}
                                    {activeSection === 'timeline' && (
                                        <div style={{ display: 'flex', flexDirection: 'column', gap: 16 }}>
                                            {config.timeline.map((item, i) => (
                                                <div key={i} className="card">
                                                    <div className="form-group" style={{ marginBottom: 12 }}><input className="form-input" value={item.title} onChange={e => updateTimeline(i, 'title', e.target.value)} placeholder="Event title" /></div>
                                                    <div className="form-group" style={{ marginBottom: 12 }}><input className="form-input" value={item.date} onChange={e => updateTimeline(i, 'date', e.target.value)} placeholder="Date" /></div>
                                                    <textarea className="form-input" style={{ minHeight: 70, resize: 'none' }} value={item.description} onChange={e => updateTimeline(i, 'description', e.target.value)} placeholder="Description..."></textarea>
                                                </div>
                                            ))}
                                            <button className="btn-secondary" onClick={() => setConfig({ ...config, timeline: [...config.timeline, { date: "Year", title: "New Event", description: "..." }] })}>+ Add Event</button>
                                        </div>
                                    )}

                                    {/* STYLE SECTION */}
                                    {activeSection === 'style' && (
                                        <>
                                            <div className="form-group">
                                                <label className="form-label">üé® Accent Color</label>
                                                <div className="color-grid">
                                                    {COLORS.map(c => (
                                                        <div key={c.id} className={`color-swatch ${accentColor === c.id ? 'active' : ''}`} style={{ background: c.color }} onClick={() => setAccentColor(c.id)} title={c.name}></div>
                                                    ))}
                                                </div>
                                            </div>

                                            <div className="form-group">
                                                <label className="form-label">üî§ Font Style</label>
                                                {FONTS.map(f => (
                                                    <div key={f.id} className={`font-option ${selectedFont === f.id ? 'active' : ''}`} onClick={() => setSelectedFont(f.id)}>
                                                        <span className="font-preview" style={{ fontFamily: f.style }}>{f.preview}</span>
                                                        <span className="font-name">{f.name}</span>
                                                    </div>
                                                ))}
                                            </div>

                                            <div className="form-group">
                                                <label className="form-label">‚ú® Animation Intensity</label>
                                                <div className="slider-container">
                                                    <input type="range" className="slider" min="1" max="3" value={animationLevel} onChange={e => setAnimationLevel(parseInt(e.target.value))} />
                                                    <div className="slider-labels">
                                                        <span>Subtle</span>
                                                        <span>Medium</span>
                                                        <span>Maximum</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </>
                                    )}

                                    {/* TEMPLATES SECTION */}
                                    {activeSection === 'templates' && (
                                        <div className="template-grid">
                                            {TEMPLATES.map(t => (
                                                <div key={t.id} className="template-card" onClick={() => applyTemplate(t)}>
                                                    <div className="template-card-header">
                                                        <span className="template-card-icon">{t.icon}</span>
                                                        <span className="template-card-title">{t.name}</span>
                                                    </div>
                                                    <p className="template-card-desc">{t.desc}</p>
                                                </div>
                                            ))}
                                        </div>
                                    )}

                                    {/* SETTINGS SECTION */}
                                    {activeSection === 'settings' && (
                                        <>
                                            {/* Animation Effects */}
                                            <div className="form-group">
                                                <label className="form-label">‚ú® Animation Effects</label>
                                                <div className="effects-grid">
                                                    <div className={`effect-item ${config.effects?.hearts ? 'active' : ''}`} onClick={() => setConfig({ ...config, effects: { ...config.effects, hearts: !config.effects?.hearts } })}>
                                                        <span className="icon">üíï</span>
                                                        <span>Hearts</span>
                                                    </div>
                                                    <div className={`effect-item ${config.effects?.sparkles ? 'active' : ''}`} onClick={() => setConfig({ ...config, effects: { ...config.effects, sparkles: !config.effects?.sparkles } })}>
                                                        <span className="icon">‚ú®</span>
                                                        <span>Sparkles</span>
                                                    </div>
                                                    <div className={`effect-item ${config.effects?.bubbles ? 'active' : ''}`} onClick={() => setConfig({ ...config, effects: { ...config.effects, bubbles: !config.effects?.bubbles } })}>
                                                        <span className="icon">ü´ß</span>
                                                        <span>Bubbles</span>
                                                    </div>
                                                </div>
                                            </div>

                                            {/* Password Lock */}
                                            <div className="form-group">
                                                <label className="form-label">üîê Password Lock</label>
                                                <input type="password" className="form-input" style={{ textAlign: 'center', letterSpacing: '0.4em', fontSize: 20 }} value={config.password} onChange={e => setConfig({ ...config, password: e.target.value })} placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" maxLength={6} />
                                            </div>

                                            {/* Share & Export */}
                                            <div style={{ borderTop: '1px solid var(--border)', paddingTop: 24, marginTop: 12 }}>
                                                <label className="form-label">üì§ Share & Export</label>
                                                <div className="share-buttons" style={{ marginBottom: 12 }}>
                                                    <button className="share-btn whatsapp" onClick={() => window.open(`https://wa.me/?text=${encodeURIComponent('Check out my Valentine! ' + previewUrl)}`)}>
                                                        üí¨ WhatsApp
                                                    </button>
                                                    <button className="share-btn copy" onClick={() => { navigator.clipboard.writeText(previewUrl); alert('Link copied!'); }}>
                                                        üìã Copy
                                                    </button>
                                                </div>
                                                <button className="share-btn download" style={{ width: '100%' }} onClick={() => alert('Download feature coming soon!')}>
                                                    üì• Download as Image
                                                </button>
                                            </div>

                                            {/* QR Code */}
                                            <div style={{ borderTop: '1px solid var(--border)', paddingTop: 24, marginTop: 24 }}>
                                                <label className="form-label">üì± Share via QR</label>
                                                <div style={{ background: 'white', padding: 20, borderRadius: 16, display: 'flex', justifyContent: 'center' }}><img src={qrCodeUrl} style={{ width: 140, height: 140 }} /></div>
                                                <p style={{ fontSize: 11, color: 'var(--text-muted)', textAlign: 'center', marginTop: 12, wordBreak: 'break-all' }}>{previewUrl}</p>
                                            </div>
                                        </>
                                    )}
                                </div>

                                <div className="publish-area">
                                    <button className="btn-primary" onClick={handleCheckout}>
                                        üöÄ Publish ‚Äî ‚Çπ{totalPrice}
                                    </button>
                                    <div style={{ display: 'flex', justifyContent: 'center', gap: 8, marginTop: 12 }}>
                                        <span className="kbd">‚åòS</span>
                                        <span style={{ fontSize: 11, color: 'var(--text-muted)' }}>to publish</span>
                                    </div>
                                </div>
                            </div>
                        )
                    }

                    {/* SUCCESS / PENDING MODAL */}
                    <div className={`modal-backdrop ${orderData ? 'open' : ''}`}>
                        <div className="modal-card" style={{ maxWidth: 420 }}>
                            {/* PENDING VERIFICATION */}
                            {orderData?.pending ? (
                                <>
                                    <div style={{ fontSize: 56, marginBottom: 20 }}>‚è≥</div>
                                    <h2 style={{ fontSize: 24, fontWeight: 800, marginBottom: 8 }}>Payment Submitted!</h2>
                                    <p style={{ color: 'var(--text-muted)', fontSize: 14, marginBottom: 20 }}>
                                        Your payment is being verified. You'll receive your Valentine link soon!
                                    </p>

                                    <div style={{ background: 'rgba(34, 197, 94, 0.1)', border: '1px solid #22c55e', padding: 16, borderRadius: 14, marginBottom: 16 }}>
                                        <div style={{ fontSize: 13, color: '#22c55e', fontWeight: 600, marginBottom: 8 }}>‚úÖ What happens next?</div>
                                        <div style={{ fontSize: 12, color: 'var(--text-secondary)', lineHeight: 1.6 }}>
                                            1. We verify your payment (1-2 hours)<br />
                                            2. Your Valentine link is generated<br />
                                            3. Contact us on WhatsApp for instant delivery!
                                        </div>
                                    </div>

                                    <div style={{ background: 'var(--bg-tertiary)', padding: 12, borderRadius: 10, marginBottom: 16 }}>
                                        <div style={{ fontSize: 11, color: 'var(--text-muted)', marginBottom: 4 }}>Order ID (save this!)</div>
                                        <div style={{ fontFamily: 'monospace', fontSize: 16, color: 'var(--accent-purple)' }}>{orderData?.orderId}</div>
                                    </div>

                                    <button
                                        className="btn-primary"
                                        onClick={() => window.open(`https://wa.me/918709157822?text=Hi! I just paid for Order: ${orderData?.orderId}. Please verify my payment.`, '_blank')}
                                        style={{ width: '100%', marginBottom: 10 }}
                                    >
                                        üì± WhatsApp for Instant Link
                                    </button>
                                    <button className="btn-secondary" onClick={() => setOrderData(null)} style={{ width: '100%' }}>Close</button>
                                </>
                            ) : orderData?.success ? (
                                <>
                                    {/* VERIFIED - SHOW SHARE LINK */}
                                    <div style={{ fontSize: 56, marginBottom: 20 }}>üéâ</div>
                                    <h2 style={{ fontSize: 24, fontWeight: 800, marginBottom: 8 }}>Payment Verified!</h2>
                                    <p style={{ color: 'var(--text-muted)', fontSize: 14, marginBottom: 20 }}>Your Valentine's page is live! Share it with your loved one:</p>

                                    {orderData?.shareUrl && (
                                        <div style={{ background: 'var(--bg-primary)', padding: 16, borderRadius: 14, marginBottom: 16, border: '2px solid var(--accent)' }}>
                                            <div style={{ fontSize: 11, color: 'var(--text-muted)', marginBottom: 6 }}>üíï YOUR VALENTINE LINK</div>
                                            <div style={{ fontFamily: 'monospace', fontSize: 14, color: 'var(--accent)', wordBreak: 'break-all', marginBottom: 12 }}>
                                                {window.location.origin}{orderData.shareUrl}
                                            </div>
                                            <div style={{ display: 'flex', gap: 8 }}>
                                                <button
                                                    className="btn-secondary"
                                                    style={{ flex: 1, padding: 10, fontSize: 13 }}
                                                    onClick={() => {
                                                        navigator.clipboard.writeText(window.location.origin + orderData.shareUrl);
                                                        alert('Link copied! üíï');
                                                    }}
                                                >
                                                    üìã Copy Link
                                                </button>
                                                <button
                                                    className="btn-primary"
                                                    style={{ flex: 1, padding: 10, fontSize: 13 }}
                                                    onClick={() => {
                                                        const url = window.location.origin + orderData.shareUrl;
                                                        const text = `I made something special for you! üíï\n${url}`;
                                                        window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
                                                    }}
                                                >
                                                    üì± WhatsApp
                                                </button>
                                            </div>
                                        </div>
                                    )}

                                    <div style={{ background: 'var(--bg-tertiary)', padding: 12, borderRadius: 10, marginBottom: 20 }}>
                                        <div style={{ fontSize: 11, color: 'var(--text-muted)' }}>Order ID: <span style={{ color: 'var(--accent-purple)' }}>{orderData?.orderId}</span></div>
                                    </div>

                                    <button className="btn-secondary" onClick={() => setOrderData(null)} style={{ width: '100%' }}>Close</button>
                                </>
                            ) : null}
                        </div>
                    </div>

                    {/* AI MODAL */}
                    <div className={`modal-backdrop ${aiModalOpen ? 'open' : ''}`} onClick={(e) => e.target.className.includes('modal-backdrop') && setAiModalOpen(false)}>
                        <div className="modal-card">
                            <div style={{ fontSize: 48, marginBottom: 16 }}>‚ú®</div>
                            <h2 style={{ fontSize: 20, fontWeight: 700, marginBottom: 8 }}>Magic Writer</h2>
                            <p style={{ color: 'var(--text-muted)', fontSize: 13, marginBottom: 24 }}>Select a mood for your love letter.</p>
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: 10, marginBottom: 20 }}>
                                {['Romantic', 'Funny', 'Poetic', 'Short'].map(m => (
                                    <button key={m} className="btn-secondary" onClick={() => generateLoveLetter(m.toLowerCase())} style={{ padding: 12 }}>{m}</button>
                                ))}
                            </div>
                            <button className="btn-no" style={{ width: '100%', padding: 12, border: 'none', background: 'transparent', color: 'var(--text-muted)', cursor: 'pointer' }} onClick={() => setAiModalOpen(false)}>Cancel</button>
                        </div>
                    </div>

                    {/* AUTH MODAL */}
                    {
                        authModal && (
                            <div className="modal-backdrop open" onClick={(e) => e.target.className.includes('modal-backdrop') && setAuthModal(null)}>
                                <div className="modal-card" style={{ maxWidth: 380 }}>
                                    <div style={{ fontSize: 48, marginBottom: 16 }}>{authModal === 'login' ? 'üîê' : 'üë§'}</div>
                                    <h2 style={{ fontSize: 20, fontWeight: 700, marginBottom: 8 }}>
                                        {authModal === 'login' ? 'Welcome Back!' : 'Create Account'}
                                    </h2>
                                    <p style={{ color: 'var(--text-muted)', fontSize: 13, marginBottom: 20 }}>
                                        {authModal === 'login' ? 'Login to save your valentines' : 'Sign up to save & manage valentines'}
                                    </p>

                                    {authError && (
                                        <div style={{ background: 'rgba(239, 68, 68, 0.1)', border: '1px solid #ef4444', padding: 10, borderRadius: 8, marginBottom: 16, color: '#ef4444', fontSize: 13 }}>
                                            {authError}
                                        </div>
                                    )}

                                    <form onSubmit={(e) => {
                                        e.preventDefault();
                                        const form = e.target;
                                        if (authModal === 'login') {
                                            handleLogin(form.email.value, form.password.value);
                                        } else {
                                            handleRegister(form.name.value, form.email.value, form.password.value);
                                        }
                                    }}>
                                        {authModal === 'register' && (
                                            <input name="name" className="form-input" placeholder="Your Name" required style={{ marginBottom: 10 }} />
                                        )}
                                        <input name="email" type="email" className="form-input" placeholder="Email" required style={{ marginBottom: 10 }} />
                                        <input name="password" type="password" className="form-input" placeholder="Password (min 6 chars)" required minLength="6" style={{ marginBottom: 16 }} />

                                        <button type="submit" className="btn-primary" disabled={authLoading} style={{ width: '100%', marginBottom: 12 }}>
                                            {authLoading ? '...' : (authModal === 'login' ? 'Login' : 'Create Account')}
                                        </button>
                                    </form>

                                    <div style={{ fontSize: 13, color: 'var(--text-muted)' }}>
                                        {authModal === 'login' ? (
                                            <>Don't have an account? <span style={{ color: 'var(--accent)', cursor: 'pointer' }} onClick={() => { setAuthModal('register'); setAuthError(''); }}>Sign Up</span></>
                                        ) : (
                                            <>Already have an account? <span style={{ color: 'var(--accent)', cursor: 'pointer' }} onClick={() => { setAuthModal('login'); setAuthError(''); }}>Login</span></>
                                        )}
                                    </div>

                                    <button
                                        style={{ width: '100%', padding: 12, border: 'none', background: 'transparent', color: 'var(--text-muted)', cursor: 'pointer', marginTop: 12 }}
                                        onClick={() => setAuthModal(null)}
                                    >
                                        Cancel
                                    </button>
                                </div>
                            </div>
                        )
                    }

                    {/* UPI PAYMENT MODAL */}
                    {
                        upiModal && (
                            <div className="modal-backdrop open" onClick={(e) => e.target.className.includes('modal-backdrop') && setUpiModal(null)}>
                                <div className="modal-card" style={{ maxWidth: 400 }}>
                                    <div style={{ fontSize: 48, marginBottom: 16 }}>üí≥</div>
                                    <h2 style={{ fontSize: 20, fontWeight: 700, marginBottom: 8 }}>Pay with UPI</h2>
                                    <p style={{ color: 'var(--text-muted)', fontSize: 13, marginBottom: 16 }}>Scan QR or use UPI ID to pay</p>

                                    <div style={{ background: 'white', padding: 16, borderRadius: 16, marginBottom: 16 }}>
                                        <img src={upiModal.qrUrl} alt="UPI QR" style={{ width: '100%', maxWidth: 180, margin: '0 auto', display: 'block' }} />
                                    </div>

                                    <div style={{ background: 'var(--bg-tertiary)', padding: 16, borderRadius: 12, marginBottom: 16 }}>
                                        <div style={{ fontSize: 12, color: 'var(--text-muted)', marginBottom: 4 }}>Amount</div>
                                        <div style={{ fontSize: 28, fontWeight: 700, color: 'var(--accent)' }}>‚Çπ{upiModal.amount}</div>
                                        <div style={{ fontSize: 11, color: 'var(--text-muted)', marginTop: 8 }}>
                                            UPI ID: <strong style={{ color: 'var(--text-secondary)' }}>{upiModal.upiId}</strong>
                                        </div>
                                        <div style={{ fontSize: 11, color: 'var(--text-muted)', marginTop: 4 }}>
                                            Order: <strong style={{ color: 'var(--accent-purple)' }}>{upiModal.orderId}</strong>
                                        </div>
                                    </div>

                                    <p style={{ fontSize: 12, color: 'var(--text-muted)', marginBottom: 12 }}>After payment, enter your UPI Transaction ID:</p>
                                    <input
                                        id="txnInput"
                                        className="form-input"
                                        placeholder="e.g. 401234567890"
                                        style={{ marginBottom: 12, textAlign: 'center', letterSpacing: '0.05em' }}
                                    />
                                    <button
                                        className="btn-primary"
                                        onClick={() => {
                                            const txn = document.getElementById('txnInput').value;
                                            if (txn.length > 5) confirmPayment(txn);
                                            else alert('Please enter valid Transaction ID');
                                        }}
                                    >
                                        ‚úÖ I've Paid - Confirm
                                    </button>
                                    <button
                                        style={{ width: '100%', padding: 12, border: 'none', background: 'transparent', color: 'var(--text-muted)', cursor: 'pointer', marginTop: 8 }}
                                        onClick={() => setUpiModal(null)}
                                    >
                                        Cancel
                                    </button>
                                </div>
                            </div>
                        )
                    }


                    {/* FLOATING BOTTOM ACTION BAR */}
                    <div className="bottom-action-bar">
                        <div className="live-badge">
                            <div className="live-dot"></div>
                            Editing
                        </div>
                        <div className="action-divider"></div>
                        <button className="action-btn" title="Undo">‚Ü©Ô∏è Undo</button>
                        <button className="action-btn" title="Redo">‚Ü™Ô∏è Redo</button>
                        <div className="action-divider"></div>
                        <button className="action-btn" onClick={() => setMode(mode === 'desktop' ? 'mobile' : 'desktop')}>
                            {mode === 'desktop' ? 'üì±' : 'üñ•Ô∏è'} {mode === 'desktop' ? 'Mobile' : 'Desktop'}
                        </button>
                        <button className="action-btn primary" onClick={handleCheckout}>
                            üöÄ Publish ‚Äî ‚Çπ{totalPrice}
                        </button>
                    </div>
                </div >
            );
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>

</html>